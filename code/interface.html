<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />

		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

		<title>A game of politics</title>
		
		<meta name="description" content="Play the game" />
		<meta name="author" content="Sander Latour and Frank Smit" />

		<link rel="stylesheet" href="style.css" />

		<script src="inheritance.js"></script>
		<script src="Queue.js"></script>
		<script src="Game.js"></script>
		<script src="GameController.js"></script>
		<script src="GameState.js"></script>
		<script src="EmotionState.js"></script>
		<script src="ActionTree.js"></script>
		<script src="ActionNode.js"></script>
		<script src="Agent.js"></script>
		<script src="HumanAgent.js"></script>
		
		<script>
			function start() {
				flash_lights();
        		var game = new Game();
        		game.init();
			}

		function requestApproval(gamecontroller, request) {	
		  // get the reference for the body
		  //var mybody = document.getElementsByTagName("body")[0];
		  var divgame = document.getElementById("game-view");
		  while(divgame.firstChild){
			divgame.removeChild(divgame.firstChild);
		  }
	  
		  // creates <table> and <tbody> elements
		  mytable     = document.createElement("table");
		  mytablebody = document.createElement("tbody");
				  
				  for(var j = 0; j < request.length; j++) {
					  row = document.createElement("tr");
					  row.setAttribute("height", "100px");
					  
					  row.setAttribute("id", "agent"+j);
					  
					  cell1 = document.createElement("td");
					  cell1.setAttribute('width', '60px');
					  var oImg=document.createElement("img");
					  oImg.setAttribute('src', '../images/'+request[j].agent.getImg());
					  oImg.setAttribute('alt', request[j].agent.getName());
					  oImg.setAttribute('width', '50px');
					  oImg.setAttribute('heigth', '100px');
					  cell1.appendChild(oImg);
					  text1 =  document.createTextNode(
						  request[j].agent.getEmotion().getLabel()+
						  " ("+
						  request[j].agent.getEnergy()+
						  ")"
					  );
					  cell1.appendChild(text1);
					  
					  row.appendChild(cell1);
					  
					  cell2 = document.createElement("td");
					  text2 =  document.createTextNode(request[j].action.getDescription());
					  cell2.appendChild(text2);
					  cell2.setAttribute('width', '300px');
					  
					  row.appendChild(cell2);
					  
					  cell3 = document.createElement("td");
					  consequenceText = "";
					  
					  for(var key in request[j].action.getEffects()) {
						  consequenceText += key + " " + request[j].action.getEffects()[key] + ', ';
					  }
					  text3 = document.createTextNode(consequenceText);
					  cell3.appendChild(text3);
					  cell3.setAttribute('width', '140px');
					  
					  row.appendChild(cell3);
					  
					  cell4 = document.createElement("td");
					  
					  var buttonnode = document.createElement('input');
					  buttonnode.setAttribute('type','button');
					  buttonnode.setAttribute('value','Approve request');
					  //buttonnode.style.backgroundImage = "url(../images/approve.png)";
					  //buttonnode.setAttribute('source', '../images/approve.png');
						//buttonnode.setAttribute("width","100");
						//buttonnode.setAttribute("height","100");
					  
					  buttonnode.onclick = (function(k){ return function(){
						  gamecontroller.perform(request[k].action) }
					  })(j);
					  
					  cell4.appendChild(buttonnode);
					  cell4.setAttribute('width', '150px');
					  
					  row.appendChild(cell4);
					  
					  mytablebody.appendChild(row);
					  
				  }
		  
			  // appends <tbody> into <table>
			  mytable.appendChild(mytablebody);
			  // appends <table> into <body>
			  divgame.appendChild(mytable);
			  
			  //mytable.setAttribute('id', 'game-view');
			  // sets the border attribute of mytable to 2;
			  mytable.setAttribute("border","0");
			  mytable.setAttribute('align', 'center');
			  mytable.setAttribute('width', '700px')
			  // creating all cells
			}
			
			function flash_lights () {
				var colors = new Array ("green", "white");
				
				var rand_no = Math.random();
				rand_no = parseInt (rand_no * colors.length);
				color = colors[rand_no];
				
				for (var i=0; i<document.images.length;i++) {
					document.images[i].style.visibility = "visible";
					if(document.images[i].id == color) {
						document.images[i].style.visibility = "hidden";
					}
				}
				
				setTimeout('flash_lights()', 1000 );
			}




		</script>

	</head>
	<body onload="start()">
		<div id="game-content">
			<div id="game-view"></div>
			<div id=info>
				<div id=game-info>
					<p> Here comes some information about the game, maybe what level etc </p>
				</div>
				<div id=world-state>
					<p> Here come information about the level of power you have etc</p>
				</div>
				<div id="buttons">
					<img id=green src=../images/green.png width=20 height=20 style=position:absolute;z-index:1;>
					<img id=white src=../images/white.png width=20 height=20 style=position:absolute;z-index:0;>
				</div>
			</div>
	</body>
</html>
